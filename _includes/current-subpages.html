{%- if include.content and page.dir contains include.content -%}

  {%- assign lists = site.pages | sort: 'path' | reverse -%}
  {%- for list in lists -%}
    {%- if forloop.first -%}
    <div class="row row-cols-1 row-cols-md-3 row-cols-sm-2">
    {%- endif -%}
      {%- capture slug -%}{{ list.url | split: "/" | last }}{%- endcapture -%}
      {%- capture current -%}{{ list.url | remove: slug | remove: "//" | append: "/" }}{%- endcapture -%}
      {%- if page.dir == current and page.navhide != 1 -%}
        <div class="col mb-4">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">
                <a href="{{ list.url }}">
                  {%- if list.navtitle -%}{{ list.navtitle }}{%- else -%}{{ list.title }}{%- endif -%}
                </a>
              </h5>
              <p class="card-text">
                Перелік депутатів місцевої ради обраних на чергових місцевих виборах України у {{ slug | split: "-" | first }} році
              </p>
            </div>
          </div>
        </div>
      {%- endif -%}
    {%- if forloop.last -%}
    </div>
    {%- endif -%}
  {%- else -%}
    [...nothing...]
  {%- endfor -%}

{%- elsif include.page == "district" and include.dir != page.dir and include.dir contains page.dir -%}

  {%- assign lists = site.pages | sort: 'path' | reverse -%}
  {%- for list in lists -%}
    {%- if forloop.first -%}
    <div class="row row-cols-1 row-cols-md-3 row-cols-sm-2">
    {%- endif -%}
      {%- capture slug -%}{{ list.url | split: "/" | last }}{%- endcapture -%}
      {%- capture current -%}{{ list.url | remove: slug | remove: "//" | append: "/" }}{%- endcapture -%}
      {%- if include.dir == current and list.navhide != 1 -%}
        <div class="col mb-4">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">
                <a href="{{ list.url }}">
                  {%- if list.navtitle -%}{{ list.navtitle }}{%- else -%}{{ list.title }}{%- endif -%}
                </a>
              </h5>
              <p class="card-text">
                Перелік депутатів місцевої ради обраних на чергових місцевих виборах України у {{ slug | split: "-" | first }} році
              </p>
            </div>
          </div>
        </div>
      {%- endif -%}
    {%- if forloop.last -%}
    </div>
    {%- endif -%}
  {%- else -%}
    [...nothing...]
  {%- endfor -%}

{%- elsif include.page == "home" and include.dir != page.dir and include.dir contains page.dir -%}

### 0.5 ### <br>

{% assign pages = site.pages | sort: 'order' %}

<ul>
{% for node in pages %}
  {% assign node_parts = node.url | split: '/' %}
  {% assign node_depth = node_parts | size %}

  {% if node_depth == 2 %}
    <li{% if page.url contains node.url %} class="active"{% endif %}>
      <a href="{{ node.url }}">
        {% if node.link %}
          {{ node.link }}
        {% else %}
          {{ node.title }}
        {% endif %}
      </a>

      {% assign node_root = '/' | append: node_parts[1] | append: '/' %}
      {% assign has_children = false %}
      {% for subnode in pages %}
        {% if subnode.url contains node_root and subnode.url != node_root %}
          {% assign has_children = true %}
        {% endif %}
      {% endfor %}

      {% if has_children == true %}
        <ul>
          {% for subnode in pages %}
            {% if subnode.url contains node_root and subnode.url != node_root %}
              {% assign node_parts = subnode.url | split: '/' %}
              {% assign node_depth = node_parts | size %}

              {% if node_depth == 3 %}
                <li{% if page.url contains subnode.url %} class="active"{% endif %}>
                  <a href="{{ subnode.url }}">
                    {% if subnode.link %}
                      {{ subnode.link }}
                    {% else %}
                      {{ subnode.title }}
                    {% endif %}
                  </a>

                  {% assign subnode_root = '/' | append: node_parts[1] | append: '/' | append: node_parts[2] | append: '/' %}
                  {% assign has_children = false %}
                  {% for subsubnode in pages %}
                    {% if subsubnode.url contains subnode_root and subsubnode.url != subnode_root %}
                      {% assign has_children = true %}
                    {% endif %}
                  {% endfor %}

                  {% if has_children == true %}
                    <ul>
                      {% for subsubnode in pages %}
                        {% if subsubnode.url contains subnode_root and subsubnode.url != subnode_root %}
                          <li{% if page.url contains subsubnode.url %} class="active"{% endif %}>
                            <a href="{{ subsubnode.url }}">
                              {% if subsubnode.link %}
                                {{ subsubnode.link }}
                              {% else %}
                                {{ subsubnode.title }}
                              {% endif %}
                            </a>
                          </li>
                        {% endif %}
                      {% endfor %}
                    </ul>
                  {% endif %}
                </li>
              {% endif %}
            {% endif %}
          {% endfor %}
        </ul>
      {% endif %}
    </li>
  {% endif %}
{% endfor %}
</ul>



{% comment %}
  {%- assign lists = site.pages | sort: 'path' | reverse -%}
  {%- for list in lists -%}
    {%- if forloop.first -%}
    <div class="row row-cols-1">
    {%- endif -%}
      {%- capture slug -%}{{ list.url | split: "/" | last }}{%- endcapture -%}
      {%- capture current -%}{{ list.url | remove: slug | remove: "//" | append: "/" }}{%- endcapture -%}
      {%- if include.dir == current and list.navhide != 1 -%}
        <div class="col">
          <div class="card h-100 border-0">
            <div class="card-body px-0 pt-0">
              <h5 class="card-title mb-1">
                <a href="{{ list.url }}">
                  {%- if list.navtitle -%}{{ list.navtitle }}{%- else -%}{{ list.title }}{%- endif -%}
                </a>
              </h5>
              <p class="card-text mb-1">
                Перелік депутатів місцевої ради обраних на чергових місцевих виборах України у {{ slug | split: "-" | first }} році
              </p>
            </div>
          </div>
        </div>
      {% else %}
      {%- endif -%}
    {%- if forloop.last -%}
    </div>
    {%- endif -%}
  {%- else -%}
    [...nothing...]
  {%- endfor -%}
{% endcomment %}

{%- else -%}

<ul class="list-group">
  {%- assign lists = site.pages | sort: 'path' | reverse -%}
  {%- for list in lists -%}
    {%- capture slug -%}{{ list.url | split: "/" | last }}{%- endcapture -%}
    {%- capture current -%}{{ list.url | remove: slug | remove: "//" | append: "/" }}{%- endcapture -%}
    {%- if page.dir == current and page.navhide != 1 -%}
      <li class="list-group-item">
          <a href="{{ list.url }}">
            {%- if list.navtitle -%}{{ list.navtitle }}{%- else -%}{{ list.title }}{%- endif -%}
          </a>
      </li>
    {%- endif -%}
  {%- else -%}
  {%- endfor -%}
</ul>

{%- endif -%}
